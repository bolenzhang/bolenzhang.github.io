
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>以太坊实战-1：搭建私链并部署智能合约 | Bolen`s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Bolen Zhang">
    

    
    <meta name="description" content="搭建以太坊私链并部署智能合约1、下载1$ git clone https://github.com/ethereum/go-ethereum.git 2、编译1234$ cd go-ethereum$ make geth windows下是：go install -v ./...//其实就是去下载安装一些依赖的静态库 将 geth 添加到环境变量中 vi ~/.bashrc 12export GE">
<meta name="keywords" content="以太坊应用,私链">
<meta property="og:type" content="article">
<meta property="og:title" content="以太坊实战-1：搭建私链并部署智能合约">
<meta property="og:url" content="http://yoursite.com/2018/04/29/以太坊私链搭建及智能合约部署/index.html">
<meta property="og:site_name" content="Bolen`s Blog">
<meta property="og:description" content="搭建以太坊私链并部署智能合约1、下载1$ git clone https://github.com/ethereum/go-ethereum.git 2、编译1234$ cd go-ethereum$ make geth windows下是：go install -v ./...//其实就是去下载安装一些依赖的静态库 将 geth 添加到环境变量中 vi ~/.bashrc 12export GE">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://p8azvgsnq.bkt.clouddn.com/Truffle%20box%E7%9B%AE%E5%BD%95.png">
<meta property="og:image" content="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%85.png">
<meta property="og:image" content="http://p8azvgsnq.bkt.clouddn.com/eth%20wallet%E6%9F%A5%E7%9C%8B%E5%90%88%E7%BA%A6.png">
<meta property="og:image" content="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%852.png">
<meta property="og:image" content="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%853.png">
<meta property="og:image" content="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%854.png">
<meta property="og:image" content="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%855.png">
<meta property="og:updated_time" content="2018-06-03T15:34:27.312Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="以太坊实战-1：搭建私链并部署智能合约">
<meta name="twitter:description" content="搭建以太坊私链并部署智能合约1、下载1$ git clone https://github.com/ethereum/go-ethereum.git 2、编译1234$ cd go-ethereum$ make geth windows下是：go install -v ./...//其实就是去下载安装一些依赖的静态库 将 geth 添加到环境变量中 vi ~/.bashrc 12export GE">
<meta name="twitter:image" content="http://p8azvgsnq.bkt.clouddn.com/Truffle%20box%E7%9B%AE%E5%BD%95.png">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Bolen`s Blog" title="Bolen`s Blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Bolen`s Blog">Bolen`s Blog</a></h1>
				<h2 class="blog-motto">Summarize &amp; share</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
						<li><a href="/index">标签</a></li>
					
						<li><a href="/categories">分类</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/04/29/以太坊私链搭建及智能合约部署/" title="以太坊实战-1：搭建私链并部署智能合约" itemprop="url">以太坊实战-1：搭建私链并部署智能合约</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Bolen Zhang" target="_blank" itemprop="author">Bolen Zhang</a>
		
  <p class="article-time">
    <time datetime="2018-04-29T12:50:11.000Z" itemprop="datePublished"> Published 2018-04-29</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#搭建以太坊私链并部署智能合约"><span class="toc-text">搭建以太坊私链并部署智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、下载"><span class="toc-text">1、下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、编译"><span class="toc-text">2、编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、搭建私有链"><span class="toc-text">3、搭建私有链</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-配置初始状态"><span class="toc-text">3.1 配置初始状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-初始化：写入创世区块"><span class="toc-text">3.2 初始化：写入创世区块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-启动私有链节点"><span class="toc-text">3.3 启动私有链节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、控制台操作"><span class="toc-text">4、控制台操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-创建账户"><span class="toc-text">4.1 创建账户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-查看账户余额"><span class="toc-text">4.2 查看账户余额</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-启动-amp-停止挖矿"><span class="toc-text">4.3 启动&amp;停止挖矿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-发送交易"><span class="toc-text">4.4 发送交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-查看交易和区块"><span class="toc-text">4.5 查看交易和区块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-小结"><span class="toc-text">4.6 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、使用TestRPC与Truffle组合搭建智能合约"><span class="toc-text">5、使用TestRPC与Truffle组合搭建智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-智能合约环境搭建"><span class="toc-text">5.1 智能合约环境搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-发布合约到私有链"><span class="toc-text">5.2 发布合约到私有链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-通过以太坊钱包来查看部署合约"><span class="toc-text">5.3 通过以太坊钱包来查看部署合约</span></a></li></ol></li></ol></li></ol>
		
		</div>
		
		<h1 id="搭建以太坊私链并部署智能合约"><a href="#搭建以太坊私链并部署智能合约" class="headerlink" title="搭建以太坊私链并部署智能合约"></a>搭建以太坊私链并部署智能合约</h1><h2 id="1、下载"><a href="#1、下载" class="headerlink" title="1、下载"></a>1、下载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/ethereum/go-ethereum.git</span><br></pre></td></tr></table></figure>
<h2 id="2、编译"><a href="#2、编译" class="headerlink" title="2、编译"></a>2、编译</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cd go-ethereum</span><br><span class="line">$ make geth </span><br><span class="line">windows下是：</span><br><span class="line">go install -v ./...//其实就是去下载安装一些依赖的静态库</span><br></pre></td></tr></table></figure>
<p>将 <code>geth</code> 添加到环境变量中 <code>vi ~/.bashrc</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export GETH=&quot;$GOPATH/src/github.com/ethereum/go-ethereum/build&quot;</span><br><span class="line">export PATH=&quot;$PATH:$GETH/bin&quot;</span><br></pre></td></tr></table></figure>
<p>然后执行 <code>source ~/.bashrc</code>，使配置生效。</p>
<p>检查是否安装成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geth --help</span><br></pre></td></tr></table></figure>
<p>如果输出一些帮助提示命令，则说明安装成功。</p>
<p>其实此处也可以直接去下载以太坊geth。就不用去编译生成geth了：</p>
<blockquote>
<p>钱包工具：<a href="https://ethfans.org/wikis/Ethereum-Wallet-Mirror" target="_blank" rel="noopener">https://ethfans.org/wikis/Ethereum-Wallet-Mirror</a> </p>
</blockquote>
<blockquote>
<p>geth :<a href="https://ethfans.org/wikis/Ethereum-Geth-Mirror" target="_blank" rel="noopener">https://ethfans.org/wikis/Ethereum-Geth-Mirror</a> </p>
</blockquote>
<h2 id="3、搭建私有链"><a href="#3、搭建私有链" class="headerlink" title="3、搭建私有链"></a>3、搭建私有链</h2><h3 id="3-1-配置初始状态"><a href="#3-1-配置初始状态" class="headerlink" title="3.1 配置初始状态"></a>3.1 配置初始状态</h3><p>要运行以太坊私有链，需要定义自己的创世区块，创世区块信息写在一个 JSON 格式的配置文件中。首先将下面的内容保存到一个 JSON 文件中，例如 <code>genesis.json</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir ~/privatechain</span><br><span class="line">$ cd privatechain</span><br><span class="line">$ vi genesis.json</span><br></pre></td></tr></table></figure>
<p><strong>genesis.json 的代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;config&quot;: &#123;</span><br><span class="line">        &quot;chainId&quot;: 10, </span><br><span class="line">        &quot;homesteadBlock&quot;: 0,</span><br><span class="line">        &quot;eip155Block&quot;: 0,</span><br><span class="line">        &quot;eip158Block&quot;: 0</span><br><span class="line">    &#125;,</span><br><span class="line">	&quot;difficulty&quot; : &quot;2000000&quot;,</span><br><span class="line">  &quot;gasLimit&quot;   : &quot;2100000&quot;,</span><br><span class="line">  &quot;alloc&quot;: &#123;</span><br><span class="line">    &quot;0x986c0D89b3804D923Ef527788c92d18106f3ba86&quot;: &#123;&quot;balance&quot;: &quot;300000&quot;&#125;,</span><br><span class="line">    &quot;0xd303F820Cff99CA74B802549ccB570e35bb0F1d4&quot;: &#123;&quot;balance&quot;: &quot;250000&quot;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中，chainID 指定了独立的区块链网络 ID。网络 ID 在连接到其他节点的时候会用到，以太坊公网的网络 ID 是 1，为了不与公有链网络冲突，运行私有链节点的时候要指定自己的网络 ID。不同 ID 网络的节点无法相互连接。配置文件还对当前挖矿难度 difficulty、区块 Gas 消耗限制 gasLimit 等参数进行了设置。</p>
<p>alloc，是把实现创建的钱包地址中预分配了一些余额。</p>
<h3 id="3-2-初始化：写入创世区块"><a href="#3-2-初始化：写入创世区块" class="headerlink" title="3.2 初始化：写入创世区块"></a>3.2 初始化：写入创世区块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geth --datadir data0 init genesis.json</span><br></pre></td></tr></table></figure>
<p>上面的命令的主体是 <code>geth init</code>，表示初始化区块链，命令可以带有选项和参数，其中 <code>--datadir</code> 选项后面跟一个目录名，这里为 <code>当前目录</code>，表示指定数据存放目录为 <code>当前目录</code>，<code>genesis.json</code> 是 <code>init</code> 命令的参数。</p>
<p>运行上面的命令，会读取 <code>genesis.json</code> 文件，根据其中的内容，将创世区块写入到区块链中。如果看到以下的输出内容，说明初始化成功了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ geth --datadir data0 init genesis.json</span><br><span class="line">INFO [06-01|22:51:47] Maximum peer count                       ETH=25 LES=0 total=25</span><br><span class="line">INFO [06-01|22:51:47] Allocated cache and file handles         database=C:\\projects\\privatechain\\geth\\ch             aindata cache=16 handles=16</span><br><span class="line">INFO [06-01|22:51:47] Persisted trie from memory database      nodes=3 size=503.00B time=0s gcnodes=0 gcsize             =0.00B gctime=0s livenodes=1 livesize=0.00B</span><br><span class="line">INFO [06-01|22:51:47] Successfully wrote genesis state         database=chaindata                                                hash=947374…5b939a</span><br><span class="line">INFO [06-01|22:51:47] Allocated cache and file handles         database=C:\\projects\\privatechain\\geth\\li             ghtchaindata cache=16 handles=16</span><br><span class="line">INFO [06-01|22:51:47] Persisted trie from memory database      nodes=3 size=503.00B time=0s gcnodes=0 gcsize             =0.00B gctime=0s livenodes=1 livesize=0.00B</span><br><span class="line">INFO [06-01|22:51:47] Successfully wrote genesis state         database=lightchaindata                                                hash=947374…5b939a</span><br></pre></td></tr></table></figure>
<p>初始化成功后，会在<code>privatechain</code> 的data0文件夹中生成 <code>geth</code> 和 <code>keystore</code> 两个文件夹，此时目录结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">privatechain</span><br><span class="line">├── data0</span><br><span class="line">│   ├── geth</span><br><span class="line">│   │   ├── chaindata</span><br><span class="line">│   │   │   ├── 000001.log</span><br><span class="line">│   │   │   ├── CURRENT</span><br><span class="line">│   │   │   ├── LOCK</span><br><span class="line">│   │   │   ├── LOG</span><br><span class="line">│   │   │   └── MANIFEST-000000</span><br><span class="line">│   │   └── lightchaindata</span><br><span class="line">│   │       ├── 000001.log</span><br><span class="line">│   │       ├── CURRENT</span><br><span class="line">│   │       ├── LOCK</span><br><span class="line">│   │       ├── LOG</span><br><span class="line">│   │       └── MANIFEST-000000</span><br><span class="line">│   └── keystore</span><br><span class="line">└── genesis.json</span><br></pre></td></tr></table></figure>
<p>其中 <code>geth/chaindata</code> 中存放的是区块数据，<code>keystore</code> 中存放的是账户数据。</p>
<h3 id="3-3-启动私有链节点"><a href="#3-3-启动私有链节点" class="headerlink" title="3.3 启动私有链节点"></a>3.3 启动私有链节点</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geth --datadir data0 --networkid 110 --rpc console --port 0</span><br></pre></td></tr></table></figure>
<p>上面命令的主体是 <code>geth console</code>，表示启动节点并进入交互式控制台，<code>--networkid</code> 选项后面跟一个数字，这里是110，表示指定这个私有链的网络id为110，并且开启了rpc服务。网络id在连接到其他节点的时候会用到，以太坊公网的网络id是1，为了不与公有链网络冲突，运行私有链节点的时候要指定自己的网络id。</p>
<p>如果要指定端口可以执行如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geth --datadir data0 --networkid 110 --rpc console --port 30304 --rpcport 8546</span><br></pre></td></tr></table></figure>
<p>注意，上面的命令如果报错，<code>Fatal: Error starting protocol stack: Access is denied.</code>，就检查下是否有其他的geth进程开启，我卡在这里半天，后来发现是我打开的钱包客户端也开启了<code>geth</code>，所以关掉钱包后就正常了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">Welcome to the Geth JavaScript console!</span><br><span class="line"></span><br><span class="line">instance: Geth/v1.8.10-unstable/windows-amd64/go1.9.4</span><br><span class="line"> modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>这是一个交互式的 JavaScript 执行环境，在这里面可以执行 JavaScript 代码，其中 &gt; 是命令提示符。在这个环境里也内置了一些用来操作以太坊的 JavaScript 对象，可以直接使用这些对象。这些对象主要包括：</p>
<ul>
<li>eth：包含一些跟操作区块链相关的方法；</li>
<li>net：包含一些查看p2p网络状态的方法；</li>
<li>admin：包含一些与管理节点相关的方法；</li>
<li>miner：包含启动&amp;停止挖矿的一些方法；</li>
<li>personal：主要包含一些管理账户的方法；</li>
<li><code>txpool</code>：包含一些查看交易内存池的方法；</li>
<li>web3：包含了以上对象，还包含一些单位换算的方法。</li>
</ul>
<p>运行上面的命令后，就启动了区块链节点并进入了该节点的控制台，可以通过命令与私有链节点进行访问，我们可以通过<code>admin.nodeInfo</code>命令查看节点摘要信息。注意，我们现在只是启动了一个节点，如果需要启动第二个节点，步骤跟上述一样，另外创建一个新文件夹，将<code>genisis.json</code>复制到目录中，指定不同的端口然后进行初始化并启动节点即可。</p>
<p>若创建多个节点，则节点之间可以通过<code>admin.addPeer</code>连接，在本机启动多个节点或者在不同的计算机上运行多个节点都可以，这样可以模拟出一个私有链网络。</p>
<h2 id="4、控制台操作"><a href="#4、控制台操作" class="headerlink" title="4、控制台操作"></a>4、控制台操作</h2><p>进入以太坊 Javascript Console 后，就可以使用里面的内置对象做一些操作，这些内置对象提供的功能很丰富，比如查看区块和交易、创建账户、挖矿、发送交易、部署智能合约等。</p>
<p>常用命令有：</p>
<ul>
<li>personal.newAccount()：创建账户；</li>
<li>personal.unlockAccount()：解锁账户；</li>
<li>eth.accounts：枚举系统中的账户；</li>
<li>eth.getBalance()：查看账户余额，返回值的单位是 Wei（Wei 是以太坊中最小货币面额单位，类似比特币中的聪，1 ether = 10^18 Wei）；</li>
<li>eth.blockNumber：列出区块总数；</li>
<li>eth.getTransaction()：获取交易；</li>
<li>eth.getBlock()：获取区块；</li>
<li>miner.start()：开始挖矿；</li>
<li>miner.stop()：停止挖矿；</li>
<li>eth.coinbase：挖矿奖励的账户</li>
<li>web3.fromWei()：Wei 换算成以太币；</li>
<li>web3.toWei()：以太币换算成 Wei；</li>
<li>txpool.status：交易池中的状态；</li>
<li><code>admin.addPeer()</code>：连接到其他节点；</li>
<li><code>admin.nodeInfo</code>：查看节点摘要信息</li>
</ul>
<h3 id="4-1-创建账户"><a href="#4-1-创建账户" class="headerlink" title="4.1 创建账户"></a>4.1 创建账户</h3><p>输入 <code>eth.accounts</code> 查询系统中的账户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.accounts</span><br><span class="line">[]</span><br></pre></td></tr></table></figure>
<p>显示为 <code>[]</code>，表示没有账户，接下来使用 <code>personal.newAccount()</code> 来创建一个账户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; personal.newAccount()</span><br><span class="line">Passphrase: </span><br><span class="line">Repeat passphrase: </span><br><span class="line">&quot;0xb327a595dfbc769d73144c060b4f34c392021dad&quot;</span><br></pre></td></tr></table></figure>
<p><code>Passphrase</code> 表示输入密码，<code>Repeat passphrase</code> 表示输入确认密码</p>
<p>再次创建一个账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; personal.newAccount()</span><br><span class="line">Passphrase: </span><br><span class="line">Repeat passphrase: </span><br><span class="line">&quot;0xc881f183d0d8cb7c3393c29e826a25b43631f910&quot;</span><br></pre></td></tr></table></figure>
<p>查看刚刚创建的用户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.accounts</span><br><span class="line">[&quot;0xfb9cc019fc650a1699d05b7fb564b83c3a72b64d&quot;, &quot;0xc6b5702b15a3794374e28f41f36e1e8dbdd564df&quot;]</span><br></pre></td></tr></table></figure>
<p>账户默认会保存在数据目录的 <code>data0/keystore</code> 文件夹中。可以查看其中的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;address&quot;: &quot;fb9cc019fc650a1699d05b7fb564b83c3a72b64d&quot;, </span><br><span class="line">    &quot;crypto&quot;: &#123;</span><br><span class="line">        &quot;cipher&quot;: &quot;aes-128-ctr&quot;, </span><br><span class="line">        &quot;ciphertext&quot;: &quot;0efae4f94134172b785f1f635be8e70342bf31e1e0ecad21d672594f09ccf572&quot;, </span><br><span class="line">        &quot;cipherparams&quot;: &#123;</span><br><span class="line">            &quot;iv&quot;: &quot;37f4f3fa2cf070b70e3eb668fad6f46f&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;kdf&quot;: &quot;scrypt&quot;, </span><br><span class="line">        &quot;kdfparams&quot;: &#123;</span><br><span class="line">            &quot;dklen&quot;: 32, </span><br><span class="line">            &quot;n&quot;: 262144, </span><br><span class="line">            &quot;p&quot;: 1, </span><br><span class="line">            &quot;r&quot;: 8, </span><br><span class="line">            &quot;salt&quot;: &quot;1cdd1cf97fb882c3d3e734223668b47c888170e795346e11d0f521a71fe3aa2a&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;mac&quot;: &quot;902a29db25a3a35a2568b04b30a8194201f07ab37c96ed1fe9af932fc1d38be0&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;id&quot;: &quot;ecd5beb2-8261-4207-8eff-2fa34678d064&quot;, </span><br><span class="line">    &quot;version&quot;: 3</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-2-查看账户余额"><a href="#4-2-查看账户余额" class="headerlink" title="4.2 查看账户余额"></a>4.2 查看账户余额</h3><p>通过 <code>eth.getBalance()</code> 可以查看账户余额</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.getBalance(eth.accounts[0])</span><br><span class="line">0</span><br><span class="line">&gt; eth.getBalance(eth.accounts[1])</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<p>目前两个账户的以太币余额都是0，要使账户有余额，可以从其他账户转账过来，或者通过挖矿来获得以太币奖励。</p>
<h3 id="4-3-启动-amp-停止挖矿"><a href="#4-3-启动-amp-停止挖矿" class="headerlink" title="4.3 启动&amp;停止挖矿"></a>4.3 启动&amp;停止挖矿</h3><p>通过 <code>miner.start()</code> 启动挖矿</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; miner.start(3)</span><br></pre></td></tr></table></figure>
<p>其中 start 的参数表示挖矿使用的线程数。第一次启动挖矿会先生成挖矿所需的 DAG 文件，这个过程有点慢，等进度达到 100% 后，就会开始挖矿，此时屏幕会被挖矿信息刷屏。</p>
<p>停止挖矿，在 console 中输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">miner.stop()</span><br></pre></td></tr></table></figure>
<p>挖到一个区块会奖励5个以太币，挖矿所得的奖励会进入矿工的账户，这个账户叫做coinbase，默认情况下coinbase是本地账户中的第一个账户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.coinbase</span><br><span class="line">&quot;0xfb9cc019fc650a1699d05b7fb564b83c3a72b64d&quot;</span><br></pre></td></tr></table></figure>
<p>可以通过 <code>miner.setEtherbase()</code> 将其他账户设置成 <code>coinbase</code> 即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; miner.setEtherbase(eth.accounts[1])</span><br><span class="line">true</span><br><span class="line">&gt; eth.coinbase</span><br><span class="line">&quot;0xc6b5702b15a3794374e28f41f36e1e8dbdd564df&quot;</span><br></pre></td></tr></table></figure>
<p>重新启动挖矿，查看 <code>eth.accounts[1]</code> 是否可以获得以太币</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; miner.start(3)</span><br><span class="line"></span><br><span class="line">//等待几秒后</span><br><span class="line">&gt; miner.stop()</span><br></pre></td></tr></table></figure>
<p>查询账户余额：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.getBalance(eth.accounts[0])</span><br><span class="line">280000000000000000000</span><br><span class="line">&gt; eth.getBalance(eth.accounts[1])</span><br><span class="line">210000000000000000000</span><br></pre></td></tr></table></figure>
<p>发现账户0 和 账号1 都有以太币，说明 <code>miner.setEtherbase()</code> 设置成功。</p>
<p><code>getBalance()</code> 返回值的单位是wei，wei是以太币的最小单位，1个以太币=10的18次方个wei。要查看有多少个以太币，可以用web3.fromWei()将返回值换算成以太币：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[0]),&apos;ether&apos;)</span><br><span class="line">280</span><br><span class="line"></span><br><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[1]),&apos;ether&apos;)</span><br><span class="line">210</span><br></pre></td></tr></table></figure>
<h3 id="4-4-发送交易"><a href="#4-4-发送交易" class="headerlink" title="4.4 发送交易"></a>4.4 发送交易</h3><p>我们从账户0转移10个以太币到账户1,首先要解锁账户 0，才能发起交易：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; personal.unlockAccount(eth.accounts[0])</span><br><span class="line">Unlock account 0xfb9cc019fc650a1699d05b7fb564b83c3a72b64d</span><br><span class="line">Passphrase: </span><br><span class="line">true</span><br></pre></td></tr></table></figure>
<p>发起交易</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; amount = web3.toWei(10,&apos;ether&apos;)</span><br><span class="line">&quot;10000000000000000000&quot;</span><br><span class="line">&gt; eth.sendTransaction(&#123;from:eth.accounts[0],to:eth.accounts[1],value:amount&#125;)</span><br><span class="line">INFO [05-29|22:37:32] Submitted transaction                    fullhash=0x493e8aa2bcb6b2a362bdbd86b2c454279e14beea43b444aeb45c7f667bf572e2 recipient=0xc6b5702B15a3794374e28f41F36e1E8dBDd564DF</span><br><span class="line">&quot;0x493e8aa2bcb6b2a362bdbd86b2c454279e14beea43b444aeb45c7f667bf572e2&quot;</span><br></pre></td></tr></table></figure>
<p>查询 账户1 的余额：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[1]),&apos;ether&apos;)</span><br><span class="line">210</span><br></pre></td></tr></table></figure>
<p>发现账户余额没有发生改变，此时交易已经提交到区块链，但还未被处理，这可以通过用 <code>txpool.status</code> 命令可以看到本地交易池中有一个待确认的交易：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; txpool.status</span><br><span class="line">&#123;</span><br><span class="line">  pending: 1,</span><br><span class="line">  queued: 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中有一条pending的交易，pending表示已提交但还未被处理的交易。</p>
<p>要使交易被处理，必须要挖矿。这里我们启动挖矿，然后等待挖到一个区块之后就停止挖矿：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;miner.start(1);admin.sleepBlocks(1);miner.stop()</span><br><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[1]),&apos;ether&apos;)</span><br><span class="line">225.000378</span><br></pre></td></tr></table></figure>
<p>发现账户收到了账户的钱，还多了5个以太币。其实多出的5个以太币是挖矿奖励。</p>
<h3 id="4-5-查看交易和区块"><a href="#4-5-查看交易和区块" class="headerlink" title="4.5 查看交易和区块"></a>4.5 查看交易和区块</h3><p>查看当前区块总数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.blockNumber</span><br><span class="line">99</span><br></pre></td></tr></table></figure>
<p>通过区块号查看区块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.getBlock(6)</span><br><span class="line">&#123;</span><br><span class="line">  difficulty: 131328,</span><br><span class="line">  extraData: &quot;0xd98301080a846765746888676f312e31302e328664617277696e&quot;,</span><br><span class="line">  gasLimit: 3160033,</span><br><span class="line">  gasUsed: 0,</span><br><span class="line">  hash: &quot;0x9679d0dc01045c3d15cbf29241ae1cd6de2e5661d3387c0980f6397e3fd9ed2c&quot;,</span><br><span class="line">  logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;,</span><br><span class="line">  miner: &quot;0xfb9cc019fc650a1699d05b7fb564b83c3a72b64d&quot;,</span><br><span class="line">  mixHash: &quot;0x05c369134eac2cb6227860b4ed11527b11825af3541712c5704914576c37c0a0&quot;,</span><br><span class="line">  nonce: &quot;0x00168a9831624417&quot;,</span><br><span class="line">  number: 6,</span><br><span class="line">  parentHash: &quot;0xad68f0a581cf2144b8a05190b6310c7a9d945d9c338fd16b4708651b8813ad8b&quot;,</span><br><span class="line">  receiptsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;,</span><br><span class="line">  sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;,</span><br><span class="line">  size: 537,</span><br><span class="line">  stateRoot: &quot;0xfaa0a4ffe160a2937b967f9780ae0de51a465bcce6a3f6f3aa24b903df3d44a0&quot;,</span><br><span class="line">  timestamp: 1527602736,</span><br><span class="line">  totalDifficulty: 918144,</span><br><span class="line">  transactions: [],</span><br><span class="line">  transactionsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;,</span><br><span class="line">  uncles: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过交易hash（hash 值包含在上面交易返回值中）查看交易：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">eth.getTransaction(&quot;0x493e8aa2bcb6b2a362bdbd86b2c454279e14beea43b444aeb45c7f667bf572e2&quot;)</span><br><span class="line">&#123;</span><br><span class="line">  blockHash: &quot;0xbe60f7ccddcb7cab39a7b932c0d89d37ac13ae14521cfdcb8ac359a5b6773655&quot;,</span><br><span class="line">  blockNumber: 99,</span><br><span class="line">  from: &quot;0xfb9cc019fc650a1699d05b7fb564b83c3a72b64d&quot;,</span><br><span class="line">  gas: 90000,</span><br><span class="line">  gasPrice: 18000000000,</span><br><span class="line">  hash: &quot;0x493e8aa2bcb6b2a362bdbd86b2c454279e14beea43b444aeb45c7f667bf572e2&quot;,</span><br><span class="line">  input: &quot;0x&quot;,</span><br><span class="line">  nonce: 0,</span><br><span class="line">  r: &quot;0x8da41e865d399fc4d8f813a39116e486db7658a04ea1f89ca0b7f44c02dd3c57&quot;,</span><br><span class="line">  s: &quot;0x15edd22404460cfc5e86c9735774a02aad024bc8c369ec531e4485f1012cbcf6&quot;,</span><br><span class="line">  to: &quot;0xc6b5702b15a3794374e28f41f36e1e8dbdd564df&quot;,</span><br><span class="line">  transactionIndex: 0,</span><br><span class="line">  v: &quot;0x37&quot;,</span><br><span class="line">  value: 10000000000000000000</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-6-小结"><a href="#4-6-小结" class="headerlink" title="4.6 小结"></a>4.6 小结</h3><p>​    如果希望某个节点上的数据要写入到区块，并且同步到网络中的其他节点，必须要启动挖矿，挖矿就是一个区块打包和传播同步的过程，同时也只有启动挖矿，才能让私有链中的主帐号得以太币，进而可以用来继续测试转账交易、合约部署、合约调用等功能。</p>
<p>这种配置私有链的方式还是有些麻烦。对于想快速方便进行测试使用以及只能合约开发的读者，还有一种配置私有链的方式，那就是使用TestRPC与Truffle组合。<strong>TestRPC是在本地使用内存模拟的一个以太坊环境，可以用于搭建测试环境，基于Node.js开发，</strong>因此使用TestRPC首先要安装Node.js环境并且版本要大于6.9.1。<strong>Truffle是针对以太坊智能合约应用的一套开发框架</strong>。我们来看下具体如何搭建。</p>
<h2 id="5、使用TestRPC与Truffle组合搭建智能合约"><a href="#5、使用TestRPC与Truffle组合搭建智能合约" class="headerlink" title="5、使用TestRPC与Truffle组合搭建智能合约"></a>5、使用TestRPC与Truffle组合搭建智能合约</h2><h3 id="5-1-智能合约环境搭建"><a href="#5-1-智能合约环境搭建" class="headerlink" title="5.1 智能合约环境搭建"></a>5.1 智能合约环境搭建</h3><p>1）使用<code>npm</code>安装<code>TestRPC</code>，命令如下：</p>
<p>注意：<code>testrpc</code>已改名为ganache-cli，本文以testrpc为例，实际上两者同样东西的不同叫法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g ethereumjs-testrpc</span><br></pre></td></tr></table></figure>
<p>2）查看版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">testrpc -version</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">$ testrpc -version</span><br><span class="line">EthereumJS TestRPC v6.0.3 (ganache-core: 2.0.2)</span><br><span class="line"></span><br><span class="line">Available Accounts</span><br><span class="line">==================</span><br><span class="line">(0) 0x6f41fffc0338e715e8aac4851afc4079b712af70 🔒</span><br><span class="line">(1) 0xad8926fdb14c2ca283ab1e8a05c0b6707bc03f97 🔒</span><br><span class="line">(2) 0x1cb0ff92ec067169fd6b1b12c6d39a4f6c2cf6f9 🔒</span><br><span class="line">(3) 0x594b70524993798cb093ca8a2bd7f02f904b66d3 🔒</span><br><span class="line">(4) 0x2f1ee0930f00b0f3cdab66d916cbd1fa4fe9535a 🔒</span><br><span class="line">(5) 0x5513a551c5aafaa8719a0df5bf398d4b3af4e211 🔒</span><br><span class="line">(6) 0xa1bf121993c23cc467eec8b7e453011dae250404 🔒</span><br><span class="line">(7) 0xe0b161979ebca95235c4cfeddfd11fb30d782a4d 🔒</span><br><span class="line">(8) 0x093b30604ac41e054e71b670d8e3ab68360017c9 🔒</span><br><span class="line">(9) 0x1cac60d851a44305d7dd6ecf8ff32f3403427d3d 🔒</span><br><span class="line"></span><br><span class="line">Private Keys</span><br><span class="line">==================</span><br><span class="line">(0) db3ecbc77961edb030858411850bd1ed12915dcf3c13762ec3692989810c2870</span><br><span class="line">(1) e0cc6b69516123fdf5d739dc9109ab486cf385affba555f0f03a7c74d7c1a88f</span><br><span class="line">(2) cea171049aa817c8ecade84ed8d20ce9e2312bed6e0f39548c9673a65bd47a47</span><br><span class="line">(3) e7f5cbba7403d0c5ea421f6ce64165b79d5c13594ad4a0ffa27896b498d6f5ad</span><br><span class="line">(4) 6d1cd1fa965caf8a0b073faff072732de0eb0a8c153cc355f89eedb49c12ed12</span><br><span class="line">(5) c535a490deefd452daab45b01daaf34366d6748afa5f0778aac5dae6c590c135</span><br><span class="line">(6) 1292992fba6774016899237b8eb217108c5f9021e0e334aa5fad3db62e5c406b</span><br><span class="line">(7) 03d02b40ab919c9d51e26fdc2e70c221d65ec1970f1283acad8b3445c5771f56</span><br><span class="line">(8) 018069b07dc4d177a612ef0e20f63b9962781ab2d57d2ad50d9361a9be804bc4</span><br><span class="line">(9) cd348e9ee0bc2cfbda9b9822d42b3dd3b83d180425bc153ffbc7e7e5bf13fa28</span><br><span class="line"></span><br><span class="line">HD Wallet</span><br><span class="line">==================</span><br><span class="line">Mnemonic:      say slight close trip refuse seven marble fun edge galaxy cash pioneer</span><br><span class="line">Base HD Path:  m/44&apos;/60&apos;/0&apos;/0/&#123;account_index&#125;</span><br><span class="line"></span><br><span class="line">Listening on localhost:8545</span><br></pre></td></tr></table></figure>
<p>3）输出信息（如上）</p>
<p>可以看到，默认就自动配置了10个账户地址。注意，以上信息是动态的，每次启动是随机生成，不是固定的。通过最后一行数据的提示，表明TestTPC启动后使用8545端口监听。</p>
<p>4）使用npm安装Truffle，命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g truffle</span><br></pre></td></tr></table></figure>
<p>5）安装成功后，输入truffle–version，输出如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ truffle --version</span><br><span class="line">Truffle v4<span class="number">.1</span><span class="number">.11</span> - a development framework <span class="keyword">for</span> Ethereum</span><br><span class="line"></span><br><span class="line">Usage: truffle &lt;command&gt; [options]</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  init      Initialize <span class="keyword">new</span> and empty Ethereum project</span><br><span class="line">  compile   Compile contract source files</span><br><span class="line">  migrate   Run migrations to deploy contracts</span><br><span class="line">  deploy    (alias <span class="keyword">for</span> migrate)</span><br><span class="line">  build     Execute build pipeline (<span class="keyword">if</span> configuration present)</span><br><span class="line">  test      Run JavaScript and Solidity tests</span><br><span class="line">  debug     Interactively debug any transaction on the blockchain (experimental)</span><br><span class="line">  opcode    Print the compiled opcodes <span class="keyword">for</span> a given contract</span><br><span class="line">  <span class="built_in">console</span>   Run a <span class="built_in">console</span> <span class="keyword">with</span> contract abstractions and commands available</span><br><span class="line">  develop   Open a <span class="built_in">console</span> <span class="keyword">with</span> a local development blockchain</span><br><span class="line">  create    Helper to create <span class="keyword">new</span> contracts, migrations and tests</span><br><span class="line">  install   Install a package <span class="keyword">from</span> the Ethereum Package Registry</span><br><span class="line">  publish   Publish a package to the Ethereum Package Registry</span><br><span class="line">  networks  Show addresses <span class="keyword">for</span> deployed contracts on each network</span><br><span class="line">  watch     Watch filesystem <span class="keyword">for</span> changes and rebuild the project automatically</span><br><span class="line">  serve     Serve the build directory on localhost and watch <span class="keyword">for</span> changes</span><br><span class="line">  exec      Execute a JS <span class="built_in">module</span> within <span class="keyword">this</span> Truffle environment</span><br><span class="line">  unbox     Download a Truffle Box, a pre-built Truffle project</span><br><span class="line">  version   Show version number and exit</span><br><span class="line"></span><br><span class="line">See more at http:<span class="comment">//truffleframework.com/docs</span></span><br></pre></td></tr></table></figure>
<p>6）安装solc：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g solc</span><br></pre></td></tr></table></figure>
<p>注意，安装后的命令是solcjs，这是用来编译智能合约代码的。</p>
<p>7）运行测试</p>
<p>​    首先运行TestRPC，在命令行中直接通过testrpc命令可以启动，接着开始初始化Truffle目录，命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir mytruffle &amp;&amp; cd mytruffle</span><br><span class="line">truffle init</span><br></pre></td></tr></table></figure>
<p>这个命令其实就是下载一个项目框架，也可以直接通过网址<a href="https://github.com/trufflesuite/truffle-init-webpack下载后解压缩，复制到相应目录效果是一样的。" target="_blank" rel="noopener">https://github.com/trufflesuite/truffle-init-webpack下载后解压缩，复制到相应目录效果是一样的。</a></p>
<p>或者按照上述网址的readme.md操作也可以。</p>
<p>初始化完成后，Trufflebox项目目录如下：</p>
<p><img src="http://p8azvgsnq.bkt.clouddn.com/Truffle%20box%E7%9B%AE%E5%BD%95.png" alt=""></p>
<p>其中，contracts中存放的是合约，truffle compile的时候就会在这里面寻找合约文件，migrations目录里面存放的JS文件，它帮助部署合约到以太坊网络中，他们表示了进行部署任务的步骤，truffle.js文件内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Allows us to use ES6 in our migrations and tests.</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'babel-register'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  networks: &#123;</span><br><span class="line">    development: &#123;</span><br><span class="line">      host: <span class="string">'127.0.0.1'</span>, <span class="comment">//节点地址，如果私有链一般是本机</span></span><br><span class="line">      port: <span class="number">7545</span>,  <span class="comment">//节点rpc端口</span></span><br><span class="line">      network_id: <span class="string">'*'</span> <span class="comment">// 自定义网络号</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>默认的配置与testrpc的参数是一致的，也可以根据需要修改。</p>
<p>8）启动了testrpc，也初始化了truffle，现在开始试着编写智能合约。可以看到在contracts中已经有几个示例合约了，创建一个Greeter.sol，源码如下：可以到这个网站，有很多的 <a href="https://github.com/fivedogit/solidity-baby-steps/tree/master/contracts" target="_blank" rel="noopener">contracts demo</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.17</span>; <span class="comment">// 指定 solidity 版本</span></span><br><span class="line"></span><br><span class="line">contract Greeter         <span class="comment">// The contract definition. A constructor of the same name will be automatically called on contract creation. </span></span><br><span class="line">&#123;</span><br><span class="line">    address creator;     <span class="comment">// At first, an empty "address"-type variable of the name "creator". Will be set in the constructor.</span></span><br><span class="line">    string greeting;     <span class="comment">// At first, an empty "string"-type variable of the name "greeting". Will be set in constructor and can be changed.</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="comment">//constructor(string _greeting)&#123;</span></span><br><span class="line">     <span class="comment">//   creator = msg.sender;</span></span><br><span class="line">        <span class="comment">//greeting = _greeting;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">Greetor</span>(<span class="params">string _greeting</span>) <span class="title">public</span> </span>&#123;</span><br><span class="line">        creator = msg.sender;</span><br><span class="line">        greeting = _greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// 只读函数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) <span class="title">constant</span> <span class="title">public</span> <span class="title">returns</span> (<span class="params">string</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> greeting;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getBlockNumber</span>(<span class="params"></span>) <span class="title">constant</span> <span class="title">public</span> <span class="title">returns</span> (<span class="params">uint</span>) </span>&#123; <span class="comment">// this doesn't have anything to do with the act of greeting                                                  // just demonstrating return of some global variable</span></span><br><span class="line">        <span class="keyword">return</span> block.number;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 非只读函数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setGreeting</span>(<span class="params">string _newgreeting</span>) <span class="title">public</span> </span>&#123;</span><br><span class="line">        greeting = _newgreeting;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 自毁函数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">kill</span>(<span class="params"></span>) <span class="title">public</span> </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (msg.sender == creator)  <span class="comment">// only allow this action if the account sending the signal is the creator</span></span><br><span class="line">            selfdestruct(creator);       <span class="comment">// kills this contract and sends remaining funds back to creator</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>9）在mytruffle目录中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo truffle compile</span><br></pre></td></tr></table></figure>
<p>10）编译如果没有问题，则会有如下提示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ truffle compile</span><br><span class="line">Compiling .\contracts\Greeter.sol...</span><br><span class="line">Writing artifacts to .\build\contracts</span><br></pre></td></tr></table></figure>
<p>11）看到生了一个build目录，编译没有问题就可以部署了，进入到migrations目录，编辑<code>2_deploy_contracts.js</code>，在最后一行插入“deployer.deploy”(合约名)，编辑内容如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ConvertLib = artifacts.require(<span class="string">"./ConvertLib.sol"</span>);</span><br><span class="line"><span class="keyword">var</span> MetaCoin = artifacts.require(<span class="string">"./MetaCoin.sol"</span>);</span><br><span class="line"><span class="keyword">var</span> Greeter = artifacts.require(<span class="string">"./Greeter.sol"</span>);<span class="comment">//新增</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">deployer</span>) </span>&#123;</span><br><span class="line">  deployer.deploy(ConvertLib);</span><br><span class="line">  deployer.link(ConvertLib, MetaCoin);</span><br><span class="line">  deployer.deploy(MetaCoin);</span><br><span class="line">  deployer.deploy(Greeter); <span class="comment">//新增</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>12）编辑保存后执行部署命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truffle migrate --reset //如果报错就检查下truffle.js中配置的rpc port和实际运行中的port是否一致</span><br></pre></td></tr></table></figure>
<p>Greeter合约部署完成，我的Greeter的地址为: 0xc2787552e7a9f3796b147dfa22cad41a7e58fb0b，可以通过这个地址与合约进行交互。</p>
<p>13）注意，在操作过程中一个要保证<code>TestRPC</code>是开启的，命令执行成功后，在<code>TestRPC</code>中可以看到响应，接下来调用一下合约中的方法，要调用合约的功能，得与<code>TestRPC</code>模拟节点交互，首先进入到控制台，命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truffle console</span><br></pre></td></tr></table></figure>
<p>14）进入到控制台后，执行如下命令：（与合约进行交互）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ truffle console</span><br><span class="line">truffle(development)&gt; var greeter = Greeter.at(Greeter.address)</span><br><span class="line">undefined</span><br><span class="line">truffle(development)&gt; greeter.address</span><br><span class="line">&apos;0x9d8bf4bab5bee3fcb857ffde0f819205e9813d6b&apos;</span><br><span class="line">truffle(development)&gt; greeter.greet()</span><br><span class="line">&apos;&apos;</span><br><span class="line">truffle(development)&gt; greeter.setGreeting(&quot;Hello World&quot;)</span><br><span class="line">&#123; tx: &apos;0xea98c0886e78f237d2aaadaf58db7ffce62b8023abfbf9172f8436119d7e75f4&apos;,</span><br><span class="line">  receipt:</span><br><span class="line">   &#123; transactionHash: &apos;0xea98c0886e78f237d2aaadaf58db7ffce62b8023abfbf9172f8436119d7e75f4&apos;,</span><br><span class="line">     transactionIndex: 0,</span><br><span class="line">     blockHash: &apos;0xaf3ee548e04898d6490d8072a7d7db8692f27750eb705052fa731460939d1d06&apos;,</span><br><span class="line">     blockNumber: 24,</span><br><span class="line">     gasUsed: 43439,</span><br><span class="line">     cumulativeGasUsed: 43439,</span><br><span class="line">     ...</span><br><span class="line">  logs: [] &#125;</span><br><span class="line">truffle(development)&gt; greeter.greet()</span><br><span class="line">&apos;Hello World&apos;</span><br></pre></td></tr></table></figure>
<p>合约以及创建成功，现在部署到私有链。</p>
<h3 id="5-2-发布合约到私有链"><a href="#5-2-发布合约到私有链" class="headerlink" title="5.2 发布合约到私有链"></a>5.2 发布合约到私有链</h3><p>退出ganache-cli，运行<code>geth --datadir data0 --networkid 110 --rpc console --port 30304 --rpcport 8546</code></p>
<p>1、部署</p>
<p>先解锁账户（之前做过），然后必须先开启挖矿：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; miner.start()</span><br></pre></td></tr></table></figure>
<p>切换到之前创建的私链环境，在另一个窗口中运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truffle migrate --reset</span><br></pre></td></tr></table></figure>
<p>看到以下类似信息声明以及成功部署。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ truffle migrate --reset</span><br><span class="line">Using network &apos;development&apos;.</span><br><span class="line">...</span><br><span class="line">  Replacing Greeter...</span><br><span class="line">  ... 0xfed35089e364676ed1ceca88f248b2d8cba147b281e1b4566d93947bc66f3c1d</span><br><span class="line">  Greeter: 0xd672f94aac6eea9e6a12bc41267b878562c29dc5 //合约地址</span><br><span class="line">Saving successful migration to network...</span><br><span class="line">  ... 0xa2cc625d5ff6016d4011f6c6d1638e61e36e4317e9669515fe2f901107ada30f</span><br><span class="line">Saving artifacts...</span><br></pre></td></tr></table></figure>
<p>2、查看</p>
<p>在私有链中查看合约:</p>
<p>拷贝 <code>truffle compile</code> 编译后的<code>build/contracts/Greeter.json</code>文件中的abi串，然后在 geth console 窗口中，执行以下命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var abi = JSON.parse(&apos;[&#123;&quot;constant&quot;: false, &quot;inputs&quot;: [&#123;&quot;name&quot;:&quot;_greeting,&quot;type&quot;:&quot;string&quot;&#125;], &quot;name&quot;: &quot;Greeter&quot;, &quot;outputs&quot;: [], &quot;payable&quot;: false, &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot;&#125;]&apos;)</span><br><span class="line">var greeter = eth.contract(abi).at(&apos;0xd672f94aac6eea9e6a12bc41267b878562c29dc5&apos;)  # 修改成你的 Greeter 合约地址</span><br><span class="line">&gt; greeter.greet()</span><br><span class="line">&gt; greeter.setGreeting.sendTransaction(&apos;Hello World&apos;,&#123;from:eth.accounts[0],gas:200000&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="5-3-通过以太坊钱包来查看部署合约"><a href="#5-3-通过以太坊钱包来查看部署合约" class="headerlink" title="5.3 通过以太坊钱包来查看部署合约"></a>5.3 通过以太坊钱包来查看部署合约</h3><p>通过以太坊钱也可以管理合约，更简单直观。</p>
<p><code>PRIVATE-NET</code> 表明连接的是私有链。点击右上角的合约 <code>CONTRACES</code>, 点击WATCH CONTRACT，添加我们刚创建的合约。</p>
<p><img src="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%85.png" alt=""></p>
<p><img src="http://p8azvgsnq.bkt.clouddn.com/eth%20wallet%E6%9F%A5%E7%9C%8B%E5%90%88%E7%BA%A6.png" alt=""></p>
<p>第一行填入合约地址，第二行给合约起个名字，第三个填入合约的ABI串，即合约编译<code>truffle compile</code>后的 build/contracts/Greeter.json 文件中 abi 的值。</p>
<p>添加之后，就可以在合约界面看到刚添加的合约：</p>
<p><img src="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%852.png" alt=""></p>
<p>点击 Greeter，进入合约详情页，在这里可以执行合约。</p>
<p><img src="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%853.png" alt=""></p>
<p>选择要执行的函数，输入字符串，点击 <code>EXECUTE</code>。确保私有链中挖矿在进行，提交成功之后，界面的Greet字符串会自动刷新为新赋予的值。</p>
<p><img src="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%854.png" alt=""></p>
<p>Greet 值已改变。</p>
<p><img src="http://p8azvgsnq.bkt.clouddn.com/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E9%92%B1%E5%8C%855.png" alt=""></p>
<p>在主界面可查看所有的交易，点击左上角 <code>WALLETS</code>，最下面有最近的交易列表。</p>
<p>至此，以太坊私有链环境已搭建完成，合约也能正常工作。关于怎么编写合约，移步 <a href="https://link.jianshu.com/?t=http%3A%2F%2Fsolidity.readthedocs.io%2Fen%2Flatest%2Fintroduction-to-smart-contracts.html" target="_blank" rel="noopener">solidity文档</a>。</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/以太坊/">以太坊</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/以太坊应用-私链/">以太坊应用,私链</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2018/04/29/以太坊私链搭建及智能合约部署/" data-title="以太坊实战-1：搭建私链并部署智能合约 | Bolen`s Blog" data-tsina="zliyong007" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2018/04/19/MySQL之路-2-查询/"  title="MySQL笔记[2]-查询">
 <strong>下一篇：</strong><br/> 
 <span>MySQL笔记[2]-查询
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#搭建以太坊私链并部署智能合约"><span class="toc-text">搭建以太坊私链并部署智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、下载"><span class="toc-text">1、下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、编译"><span class="toc-text">2、编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、搭建私有链"><span class="toc-text">3、搭建私有链</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-配置初始状态"><span class="toc-text">3.1 配置初始状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-初始化：写入创世区块"><span class="toc-text">3.2 初始化：写入创世区块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-启动私有链节点"><span class="toc-text">3.3 启动私有链节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、控制台操作"><span class="toc-text">4、控制台操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-创建账户"><span class="toc-text">4.1 创建账户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-查看账户余额"><span class="toc-text">4.2 查看账户余额</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-启动-amp-停止挖矿"><span class="toc-text">4.3 启动&amp;停止挖矿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-发送交易"><span class="toc-text">4.4 发送交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-查看交易和区块"><span class="toc-text">4.5 查看交易和区块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-小结"><span class="toc-text">4.6 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、使用TestRPC与Truffle组合搭建智能合约"><span class="toc-text">5、使用TestRPC与Truffle组合搭建智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-智能合约环境搭建"><span class="toc-text">5.1 智能合约环境搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-发布合约到私有链"><span class="toc-text">5.2 发布合约到私有链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-通过以太坊钱包来查看部署合约"><span class="toc-text">5.3 通过以太坊钱包来查看部署合约</span></a></li></ol></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/MySQL笔记/" title="MySQL笔记">MySQL笔记<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/others/" title="others">others<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/以太坊/" title="以太坊">以太坊<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/MySQL基础/" title="MySQL基础">MySQL基础<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Blog/" title="Blog">Blog<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/以太坊应用-私链/" title="以太坊应用,私链">以太坊应用,私链<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://liyuechun.org/" target="_blank" title="黎跃春">黎跃春</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.cnblogs.com/bolenzhang" target="_blank" title="My cnblog">My cnblog</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.ruanyifeng.com/blog" target="_blank" title="阮一峰">阮一峰</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=zliyong007&verifier=a1405918&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 立德立言 无问西东 <br/>
			</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/zliyong007" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
		<a href="mailto:zliyong007@163.com## e.g. imjark@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="Bolen Zhang">Bolen Zhang</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
