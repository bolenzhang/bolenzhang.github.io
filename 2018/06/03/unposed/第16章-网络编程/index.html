
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>GO基础【十六】：网络编程 | Bolen`s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Bolen Zhang">
    

    
    <meta name="description" content="网络编程一、网络编程基础go 的网络编程模块主要支持两种Internet协议: TCP 和 UDP. 1.1通信协议通信协议也叫网络传输协议或简称为传送协议（Communications Protocol），是指计算机通信或网络设备的共同语言。 现在最普及的计算机通信为网络通信，所以“传送协议”一般都指计算机通信的传送协议，如：TCP/IP、NetBEUI、HTTP、FTP等。 然而，传送协议也存">
<meta name="keywords" content="go基础">
<meta property="og:type" content="article">
<meta property="og:title" content="GO基础【十六】：网络编程">
<meta property="og:url" content="http://yoursite.com/2018/06/03/unposed/第16章-网络编程/index.html">
<meta property="og:site_name" content="Bolen`s Blog">
<meta property="og:description" content="网络编程一、网络编程基础go 的网络编程模块主要支持两种Internet协议: TCP 和 UDP. 1.1通信协议通信协议也叫网络传输协议或简称为传送协议（Communications Protocol），是指计算机通信或网络设备的共同语言。 现在最普及的计算机通信为网络通信，所以“传送协议”一般都指计算机通信的传送协议，如：TCP/IP、NetBEUI、HTTP、FTP等。 然而，传送协议也存">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://o7cqr8cfk.bkt.clouddn.com/17-7-29/99460206.jpg">
<meta property="og:image" content="http://o7cqr8cfk.bkt.clouddn.com/markdown/1501298857841.png">
<meta property="og:image" content="http://o7cqr8cfk.bkt.clouddn.com/markdown/1501302206747.png-yztcText">
<meta property="og:updated_time" content="2018-06-03T15:16:14.843Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GO基础【十六】：网络编程">
<meta name="twitter:description" content="网络编程一、网络编程基础go 的网络编程模块主要支持两种Internet协议: TCP 和 UDP. 1.1通信协议通信协议也叫网络传输协议或简称为传送协议（Communications Protocol），是指计算机通信或网络设备的共同语言。 现在最普及的计算机通信为网络通信，所以“传送协议”一般都指计算机通信的传送协议，如：TCP/IP、NetBEUI、HTTP、FTP等。 然而，传送协议也存">
<meta name="twitter:image" content="http://o7cqr8cfk.bkt.clouddn.com/17-7-29/99460206.jpg">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Bolen`s Blog" title="Bolen`s Blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Bolen`s Blog">Bolen`s Blog</a></h1>
				<h2 class="blog-motto">Summarize &amp; share</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
						<li><a href="/index">标签</a></li>
					
						<li><a href="/categories">分类</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/06/03/unposed/第16章-网络编程/" title="GO基础【十六】：网络编程" itemprop="url">GO基础【十六】：网络编程</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Bolen Zhang" target="_blank" itemprop="author">Bolen Zhang</a>
		
  <p class="article-time">
    <time datetime="2018-06-03T15:16:14.392Z" itemprop="datePublished"> Published 2018-06-03</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#网络编程"><span class="toc-text">网络编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、网络编程基础"><span class="toc-text">一、网络编程基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1通信协议"><span class="toc-text">1.1通信协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2TCP-IP协议"><span class="toc-text">1.2TCP/IP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#附录-OSI-七层参考模型"><span class="toc-text">附录:OSI 七层参考模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-IP-地址和端口号"><span class="toc-text">1.3 IP 地址和端口号</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-IP-地址"><span class="toc-text">1.3.1 IP 地址</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#IPV4地址"><span class="toc-text">IPV4地址</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#IPV6地址"><span class="toc-text">IPV6地址</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-2端口"><span class="toc-text">1.3.2端口</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、TCP编程"><span class="toc-text">二、TCP编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1什么是Socket"><span class="toc-text">2.1什么是Socket</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-TCP-服务端编程"><span class="toc-text">2.2 TCP 服务端编程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-TCP-客户端编程"><span class="toc-text">2.3 TCP 客户端编程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、UDP编程"><span class="toc-text">三、UDP编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-UDP服务器编程"><span class="toc-text">3.2 UDP服务器编程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、net模块其他属性和函数"><span class="toc-text">四、net模块其他属性和函数</span></a></li></ol></li></ol>
		
		</div>
		
		<h1 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程"></a>网络编程</h1><h2 id="一、网络编程基础"><a href="#一、网络编程基础" class="headerlink" title="一、网络编程基础"></a>一、网络编程基础</h2><p>go 的网络编程模块主要支持两种Internet协议: TCP 和 UDP.</p>
<h3 id="1-1通信协议"><a href="#1-1通信协议" class="headerlink" title="1.1通信协议"></a>1.1通信协议</h3><p>通信协议也叫网络传输协议或简称为传送协议（Communications Protocol），是指计算机通信或网络设备的共同语言。</p>
<p>现在最普及的计算机通信为网络通信，所以“传送协议”一般都指计算机通信的传送协议，如：TCP/IP、NetBEUI、HTTP、FTP等。</p>
<p>然而，传送协议也存在于计算机的其他形式通信，例如：面向对象编程里面对象之间的通信；操作系统内不同程序之间的消息，都需要有一个传送协议，以确保传信双方能够沟通无间。</p>
<hr>
<h3 id="1-2TCP-IP协议"><a href="#1-2TCP-IP协议" class="headerlink" title="1.2TCP/IP协议"></a>1.2<code>TCP/IP</code>协议</h3><p>在Internet中<code>TCP/IP</code>协议是使用最为广泛的通讯协议(<strong>互联网上的一种事实的标准</strong>)。TCP/IP是英文<code>Transmission Control Protocol/Internet Protocol</code>的缩写，意思是“传输控制协议/网际协议”</p>
<p>TCP/IP 协议是一个工业标准协议套件，专为跨广域网(WAN)的大型互联网络而设计。 </p>
<p>TCP/IP 网络体系结构模型就是遵循TCP/IP 协议进行通信的一种分层体系，现今，Internet和Intranet所使用的协议一般都为TCP/IP 协议。</p>
<p>在了解该协议之前，我们必须掌握基于该协议的体系结构层次，而TCP/IP体系结构分为四层。</p>
<p>第 1 层 网络接口层<br>包括用于协作IP数据在已有网络介质上传输的协议，提供TCP/IP协议的数据结构和实际物理硬件之间的接口。比如地址解析协议(Address Resolution Protocol, ARP )等。</p>
<p>第 2 层 网络层<br>对应于OSI模型的网络层，主要包含了IP、RIP等相关协议，负责数据的打包、寻址及路由。还包括网间控制报文协议(ICMP)来提供网络诊断信息。</p>
<p>第 3 层 传输层<br>对应于OSI的传输层，提供了两种端到端的通信服务，分别是TCP和UDP协议。</p>
<p>第 4 层 应用层<br>对应于OSI的应用层、表达层和会话层，提供了网络与应用之间的对话接口。包含了各种网络应用层协议，比如Http、FTP等应用协议。</p>
<p><img src="http://o7cqr8cfk.bkt.clouddn.com/17-7-29/99460206.jpg" alt=""></p>
<hr>
<h4 id="附录-OSI-七层参考模型"><a href="#附录-OSI-七层参考模型" class="headerlink" title="附录:OSI 七层参考模型"></a>附录:OSI 七层参考模型</h4><p><img src="http://o7cqr8cfk.bkt.clouddn.com/markdown/1501298857841.png"></p>
<hr>
<h3 id="1-3-IP-地址和端口号"><a href="#1-3-IP-地址和端口号" class="headerlink" title="1.3 IP 地址和端口号"></a>1.3 IP 地址和端口号</h3><h4 id="1-3-1-IP-地址"><a href="#1-3-1-IP-地址" class="headerlink" title="1.3.1 IP 地址"></a>1.3.1 IP 地址</h4><p>互联网协议地址（英语：Internet Protocol Address，又译为网际协议地址），缩写为<strong>IP地址</strong>（英语：IP Address）</p>
<p>IP 地址是分配给网络上使用网际协议（英语：Internet Protocol, IP）的设备的数字标签。常见的IP地址分为IPv4与IPv6两大类。</p>
<hr>
<h5 id="IPV4地址"><a href="#IPV4地址" class="headerlink" title="IPV4地址"></a>IPV4地址</h5><p>IP地址由32位二进制数组成，为便于使用，常以XXX.XXX.XXX.XXX形式表现，每组XXX代表小于或等于255的10进制数。例如维基媒体的一个IP地址是208.80.152.2。</p>
<p>地址可分为A、B、C、D、E五大类，其中E类属于特殊保留地址。<br>IP地址是唯一的。目前IP技术可能使用的IP地址最多可有4,294,967,296个（即232）。骤看可能觉得很难会用尽，但由于早期编码和分配上的问题，使很多区域的编码实际上被空出或不能使用。加上互联网的普及，使大部分家庭都至少有一部电脑，连同公司的电脑，以及连接网络的各种设备都消耗了大量IPv4地址资源。</p>
<p>随着互联网的快速成长，IPv4的42亿个地址的分配最终于2011年2月3日用尽[1][2]。相应的科研组织已研究出128位的IPv6，其IP地址数量最高可达3.402823669 × 1038个，届时每个人家居中的每件电器，每件对象，甚至地球上每一粒沙子都可以拥有自己的IP地址。</p>
<p>在A类、B类、C类IP地址中，如果主机号是全1，那么这个地址为直接广播地址，它是用来使路由器将一个分组以广播形式发送给特定网络上的所有主机。32位全为1的IP地址“255.255.255.255”为受限广播地址（”limited broadcast” destination address），用来将一个分组以广播方式发送给本网络中的所有主机，路由器则阻挡该分组通过，将其广播功能限制在本网内部。</p>
<hr>
<h5 id="IPV6地址"><a href="#IPV6地址" class="headerlink" title="IPV6地址"></a>IPV6地址</h5><p>IPv6地址为128位长但通常写作8组每组四个十六进制数的形式。例如：<br>2001:0db8:85a3:08d3:1319:8a2e:0370:7344<br>是一个合法的IPv6地址。</p>
<p>IPv4地址可以很容易的转化为IPv6格式。举例来说，如果IPv4的一个地址为135.75.43.52（十六进制为0x874B2B34），它可以被转化为0000:0000:0000:0000:0000:0000:874B:2B34或者::874B:2B34。同时，还可以使用混合符号（IPv4-compatible address），则地址可以为::135.75.43.52。</p>
<p>GO支持IP的类型</p>
<p>在Go的net包中定义了很多类型、函数和方法用来网络编程，其中IP的定义如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> IP []<span class="keyword">byte</span></span><br></pre></td></tr></table></figure>
<p>在net包中有很多函数来操作IP，但是其中比较有用的也就几个，其中ParseIP(s string) IP函数会把一个IPv4或者IPv6的地址转化成IP类型，请看下面的例子:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">name := <span class="string">"192.168.10.105:8282"</span></span><br><span class="line">addr := net.ParseIP(name)</span><br><span class="line"><span class="keyword">if</span> addr == <span class="literal">nil</span> &#123;</span><br><span class="line">   fmt.Println(<span class="string">"Invalid address"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   fmt.Println(<span class="string">"The address is "</span>, addr.String())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行之后你就会发现只要你输入一个IP地址就会给出相应的IP格式</p>
<hr>
<h4 id="1-3-2端口"><a href="#1-3-2端口" class="headerlink" title="1.3.2端口"></a>1.3.2端口</h4><p>在网络技术中，端口(Port)包括逻辑端口和物理端口两种类型。</p>
<p>物理端口指的是物理存在的端口，如ADSL Modem、集线器、交换机、路由器上用 于连接其他网络设备的接口，如RJ-45端口、SC端口等等。</p>
<p>逻辑端口是指逻辑意义上用于区分服务的端口，如TCP/IP协议中的服务端口，端口号的范围从0到65535，比如用于浏览网页服务的80端口，用于FTP服务的21端口等。由于物理端口和逻辑端口数量较多，为了对端口进行区分，将每个端口进行了编号，这就是端口号。</p>
<p>我们主要研究的是逻辑端口号.我们平时所说的端口号也是指的逻辑端口号</p>
<p>端口是一个软件结构，被客户程序或服务程序用来发送和接收数据，一台服务器有    256*256个端口。  端口号范围: 0 - 65535</p>
<p>0-1023是公认端口号，即已经公认定义或为将要公认定义的软件保留的</p>
<p>1024-65535是并没有公共定义的端口号，用户可以自己定义这些端口的作用。</p>
<p>端口与协议有关：TCP和UDP的端口互不相干</p>
<h2 id="二、TCP编程"><a href="#二、TCP编程" class="headerlink" title="二、TCP编程"></a>二、TCP编程</h2><p><strong>什么是 TCP 协议</strong></p>
<p>TCP（Transmission Control Protocol 传输控制协议）是一种面向连接（连接导向）的、可靠的、基于IP的传输层协议。</p>
<p>弥补了IP协议的不足，属于一种较高级的协议，它实现了数据包的有力捆绑，通过排序和重传来确保数据传输的可靠(即数据的准确传输以及完整性)。</p>
<p>排序可以保证数据的读取是按照正确的格式进行，重传则保证了数据能够准确传送到目的地！ </p>
<p>使用 TCP 协议通信是, 首先创建 TCP 连接, 主动发起连接的叫<strong>客户端</strong>, 被动响应连接的叫<strong>服务器</strong></p>
<p><strong>比如:</strong><br>当我们在浏览器中访问新浪主页时，我们自己的计算机就是客户端，浏览器会主动向新浪的服务器发起连接。如果一切顺利，新浪的服务器接受了我们的连接，一个TCP连接就建立起来的，后面的通信就是发送网页内容了。</p>
<p><img src="http://o7cqr8cfk.bkt.clouddn.com/markdown/1501302206747.png-yztcText"></p>
<h3 id="2-1什么是Socket"><a href="#2-1什么是Socket" class="headerlink" title="2.1什么是Socket"></a>2.1什么是<code>Socket</code></h3><p><code>Socket</code>又称”套接字”，应用程序通常通过”套接字”向网络发出请求或者应答网络请求，使主机间或者一台计算机上的进程间可以通讯。</p>
<p>可以把<code>Socket</code>理解成类似插座的东西, 通过<code>Socket</code>就可以发送和接受数据了, 就像插座插上电器之后就可以向外提供电能了.</p>
<p><code>TCP</code>编程的客户端和服务器端都是通过<code>Socket</code>来完成的.</p>
<p><strong><em>其实<code>UDP</code>协议通信也是使用的套接字, 和<code>TCP</code>协议稍有差别. <code>TCP</code>是面向连接的套接字, 而<code>UDP</code>是面向无连接的套接字.</em></strong></p>
<hr>
<p>套接字的起源可以追溯到20世纪70年底, 他是加利福尼亚大学的伯克利版本 Unix(也成 BSD Unix) 的一部分. 因此, 有时你可能会听过将套接字称为伯克利套接字或 BSD 套接字.</p>
<p>套接字最初是为同一主机上的应用程序锁创建, 使得主机上一个程序(也叫一个进程)与另一个允许的程序进行通信. 这就是所谓的进程间通信(Inter Process Communication   IPC)</p>
<hr>
<p>当我们知道如何通过网络端口访问到一个服务时，那么我们能够做什么呢？其实作为客户端来说，我们可以通过网络端口发送一个请求，然后得到服务器端反馈的信息。作为服务端，我们需要把我们的服务绑定到端口，并且在相应的端口上监听，当有客户端来访问时能够读取信息并且写入反馈信息。</p>
<p>在Go语言的net包中有一个类型TCPConn，这个类型可以用来作为客户端和服务器端交互的通道，他有两个主要的函数：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *TCPConn)</span> <span class="title">Write</span><span class="params">(b []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err os.Error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="params">(c *TCPConn)</span> <span class="title">Read</span><span class="params">(b []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err os.Error)</span></span></span><br></pre></td></tr></table></figure>
<p>TCPConn可以用在客户端和服务器端来读写数据。</p>
<p>还有我们需要知道一个TCPAddr类型，他表示一个TCP的地址信息，他的定义如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> TCPAddr <span class="keyword">struct</span> &#123;</span><br><span class="line">    IP IP</span><br><span class="line">    Port <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Go语言中通过ResolveTCPAddr获取一个TCPAddr</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ResolveTCPAddr</span><span class="params">(net, addr <span class="keyword">string</span>)</span> <span class="params">(*TCPAddr, os.Error)</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>net参数是”tcp4”、”tcp6”、”tcp”中的任意一个，分别表示TCPv4、TCPv6或者任意</li>
<li>addr表示域名或者IP地址，例如”<a href="http://www.google.com:80&quot;" target="_blank" rel="noopener">www.google.com:80&quot;</a> 或者”127.0.0.1:22”.</li>
</ul>
<p>TCP client<br>Go语言中通过net包中的DialTCP函数建议一个TCP连接，返回一个TCPConn类型，客户端和服务器段通过这个类型来进行数据交换。一般而言，客户端通过TCPConn写入请求信息发送到服务器端，读取服务器端反馈的信息。这个链接只有当任意一遍关闭了连接之后才失效，不然我们都可以一直使用。函数的定义如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DialTCP</span><span class="params">(net <span class="keyword">string</span>, laddr, raddr *TCPAddr)</span> <span class="params">(c *TCPConn, err os.Error)</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>net参数是”tcp4”、”tcp6”、”tcp”中的任意一个，分别表示TCPv4、TCPv6或者任意</li>
<li>laddr表示本机地址，一般设置为nil</li>
<li>raddr表示远程的服务地址</li>
</ul>
<h3 id="2-2-TCP-服务端编程"><a href="#2-2-TCP-服务端编程" class="headerlink" title="2.2 TCP 服务端编程"></a>2.2 TCP 服务端编程</h3><p>创建服务器端程序，我们知道服务器端我们需要绑定服务到对应的端口，然后监听端口，当有客户端请求到达的时候接收客户端连接。net包中有相应的函数，函数定义如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ListenTCP</span><span class="params">(net <span class="keyword">string</span>, laddr *TCPAddr)</span> <span class="params">(l *TCPListener, err os.Error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="params">(l *TCPListener)</span> <span class="title">Accept</span><span class="params">()</span> <span class="params">(c Conn, err os.Error)</span></span></span><br></pre></td></tr></table></figure>
<p>示例代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TCPServer project main.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"net"</span></span><br><span class="line">    <span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    service := <span class="string">":5000"</span></span><br><span class="line">    tcpAddr, err := net.ResolveTCPAddr(<span class="string">"tcp4"</span>, service) <span class="comment">//在Go语言中通过ResolveTCPAddr获取一个TCPAddr</span></span><br><span class="line">    checkErr(err)</span><br><span class="line">    listener, err := net.ListenTCP(<span class="string">"tcp"</span>, tcpAddr) <span class="comment">// 绑定服务器端口，进行监听</span></span><br><span class="line">    checkErr(err)</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        conn, err := listener.Accept()</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">go</span> handleClient(conn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">checkErr</span><span class="params">(err error)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Fprintf(os.Stderr, <span class="string">"Fatal error: %s"</span>, err.Error())</span><br><span class="line">        os.Exit(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleClient</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">    <span class="keyword">defer</span> conn.Close()</span><br><span class="line">    <span class="keyword">var</span> buf [<span class="number">512</span>]<span class="keyword">byte</span></span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        n, err := conn.Read(buf[<span class="number">0</span>:])</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        rAddr := conn.RemoteAddr()</span><br><span class="line">        fmt.Println(<span class="string">"Receive from client"</span>, rAddr.String(), <span class="keyword">string</span>(buf[<span class="number">0</span>:n]))</span><br><span class="line">        _, err2 := conn.Write([]<span class="keyword">byte</span>(<span class="string">"Welcome client!"</span>))</span><br><span class="line">        <span class="keyword">if</span> err2 != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-TCP-客户端编程"><a href="#2-3-TCP-客户端编程" class="headerlink" title="2.3 TCP 客户端编程"></a>2.3 TCP 客户端编程</h3><p>客户端实例代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TCPClient project main.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"net"</span></span><br><span class="line">    <span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> buf [<span class="number">512</span>]<span class="keyword">byte</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(os.Args) != <span class="number">2</span> &#123;</span><br><span class="line">        fmt.Fprintf(os.Stderr, <span class="string">"Usage: %s host:port "</span>, os.Args[<span class="number">0</span>])</span><br><span class="line">        os.Exit(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    service := os.Args[<span class="number">1</span>]</span><br><span class="line">    tcpAddr, err := net.ResolveTCPAddr(<span class="string">"tcp4"</span>, service)</span><br><span class="line">    checkErr(err)</span><br><span class="line">    conn, err := net.DialTCP(<span class="string">"tcp"</span>, <span class="literal">nil</span>, tcpAddr)</span><br><span class="line">    <span class="keyword">defer</span> conn.Close()</span><br><span class="line">    checkErr(err)</span><br><span class="line">    rAddr := conn.RemoteAddr()</span><br><span class="line">    n, err := conn.Write([]<span class="keyword">byte</span>(<span class="string">"Hello server!"</span>))</span><br><span class="line">    checkErr(err)</span><br><span class="line">    n, err = conn.Read(buf[<span class="number">0</span>:])</span><br><span class="line">    checkErr(err)</span><br><span class="line">    fmt.Println(<span class="string">"Reply from server "</span>, rAddr.String(), <span class="keyword">string</span>(buf[<span class="number">0</span>:n]))</span><br><span class="line">    os.Exit(<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">checkErr</span><span class="params">(err error)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Fprintf(os.Stderr, <span class="string">"Fatal error: %s"</span>, err.Error())</span><br><span class="line">        os.Exit(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三、UDP编程"><a href="#三、UDP编程" class="headerlink" title="三、UDP编程"></a>三、UDP编程</h2><p><strong><code>UDP</code>简介</strong> </p>
<p><code>UDP</code>也叫用户数据报协议</p>
<p><code>UDP</code>编程相比<code>TCP</code>编程简单了很多.</p>
<p>因为<code>UDP</code>不是面向连接的, 而是面向无连接的.</p>
<p><code>TCP</code>是面向连接的, 客户端和服务端必须连接之后才能通讯, 就像打电话, 必须先接通才能通话.</p>
<p><code>UDP</code>是面向无连接的, 一方负责发送数据(客户端), 只要知道对方(接受数据:服务器) 的地址就可以直接发数据了, 但是能不能达到就没有办法保证了.</p>
<p><strong>虽然用UDP传输面向无连接, 数据不可靠，但它的优点是和TCP比，速度快，对于不要求可靠到达的数据，就可以使用UDP协议。 比如局域网的视频同步, 使用 udp 是比较合适的:快, 延迟越小越好</strong></p>
<p>Go语言包中处理UDP Socket和TCP Socket不同的地方就是在服务器端处理多个客户端请求数据包的方式不同,UDP缺少了对客户端连接请求的Accept函数。其他基本几乎一模一样，只有TCP换成了UDP而已。UDP的几个主要函数如下所示：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ResolveUDPAddr</span><span class="params">(net, addr <span class="keyword">string</span>)</span> <span class="params">(*UDPAddr, os.Error)</span></span></span><br><span class="line"><span class="function">   <span class="title">func</span> <span class="title">DialUDP</span><span class="params">(net <span class="keyword">string</span>, laddr, raddr *UDPAddr)</span> <span class="params">(c *UDPConn, err os.Error)</span></span></span><br><span class="line"><span class="function">   <span class="title">func</span> <span class="title">ListenUDP</span><span class="params">(net <span class="keyword">string</span>, laddr *UDPAddr)</span> <span class="params">(c *UDPConn, err os.Error)</span></span></span><br><span class="line"><span class="function">   <span class="title">func</span> <span class="params">(c *UDPConn)</span> <span class="title">ReadFromUDP</span><span class="params">(b []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, addr *UDPAddr, err os.Error)</span></span></span><br><span class="line"><span class="function">   <span class="title">func</span> <span class="params">(c *UDPConn)</span> <span class="title">WriteToUDP</span><span class="params">(b []<span class="keyword">byte</span>, addr *UDPAddr)</span> <span class="params">(n <span class="keyword">int</span>, err os.Error)</span></span></span><br></pre></td></tr></table></figure>
<p>一个UDP的客户端代码如下所示,我们可以看到不同的就是TCP换成了UDP而已：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> (</span><br><span class="line">        <span class="string">"fmt"</span></span><br><span class="line">        <span class="string">"net"</span></span><br><span class="line">        <span class="string">"os"</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(os.Args) != <span class="number">2</span> &#123;</span><br><span class="line">            fmt.Fprintf(os.Stderr, <span class="string">"Usage: %s host:port"</span>, os.Args[<span class="number">0</span>])</span><br><span class="line">            os.Exit(<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        service := os.Args[<span class="number">1</span>]</span><br><span class="line">        udpAddr, err := net.ResolveUDPAddr(<span class="string">"udp4"</span>, service)</span><br><span class="line">        checkError(err)</span><br><span class="line">        conn, err := net.DialUDP(<span class="string">"udp"</span>, <span class="literal">nil</span>, udpAddr)</span><br><span class="line">        checkError(err)</span><br><span class="line">        _, err = conn.Write([]<span class="keyword">byte</span>(<span class="string">"anything"</span>))</span><br><span class="line">        checkError(err)</span><br><span class="line">        <span class="keyword">var</span> buf [<span class="number">512</span>]<span class="keyword">byte</span></span><br><span class="line">        n, err := conn.Read(buf[<span class="number">0</span>:])</span><br><span class="line">        checkError(err)</span><br><span class="line">        fmt.Println(<span class="keyword">string</span>(buf[<span class="number">0</span>:n]))</span><br><span class="line">        os.Exit(<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">checkError</span><span class="params">(err error)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            fmt.Fprintf(os.Stderr, <span class="string">"Fatal error "</span>, err.Error())</span><br><span class="line">            os.Exit(<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-2-UDP服务器编程"><a href="#3-2-UDP服务器编程" class="headerlink" title="3.2 UDP服务器编程"></a>3.2 UDP服务器编程</h3><p>我们来看一下UDP服务器端如何来处理：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> (</span><br><span class="line">        <span class="string">"fmt"</span></span><br><span class="line">        <span class="string">"net"</span></span><br><span class="line">        <span class="string">"os"</span></span><br><span class="line">        <span class="string">"time"</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">        service := <span class="string">":1200"</span></span><br><span class="line">        udpAddr, err := net.ResolveUDPAddr(<span class="string">"udp4"</span>, service)</span><br><span class="line">        checkError(err)</span><br><span class="line">        conn, err := net.ListenUDP(<span class="string">"udp"</span>, udpAddr)</span><br><span class="line">        checkError(err)</span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            handleClient(conn)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">handleClient</span><span class="params">(conn *net.UDPConn)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> buf [<span class="number">512</span>]<span class="keyword">byte</span></span><br><span class="line">        _, addr, err := conn.ReadFromUDP(buf[<span class="number">0</span>:])</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        daytime := time.Now().String()</span><br><span class="line">        conn.WriteToUDP([]<span class="keyword">byte</span>(daytime), addr)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">checkError</span><span class="params">(err error)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            fmt.Fprintf(os.Stderr, <span class="string">"Fatal error "</span>, err.Error())</span><br><span class="line">            os.Exit(<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="四、net模块其他属性和函数"><a href="#四、net模块其他属性和函数" class="headerlink" title="四、net模块其他属性和函数"></a>四、net模块其他属性和函数</h2><p>控制TCP连接</p>
<p>TCP连接有很多控制函数，我们平常用到比较多的有如下几个函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func (c *TCPConn) SetTimeout(nsec int64) os.Error</span><br><span class="line">func (c *TCPConn) SetKeepAlive(keepalive bool) os.Error</span><br></pre></td></tr></table></figure>
<p>第一个函数用来设置超时时间，客户端和服务器端都适用，当超过设置的时间时那么该链接就失效。</p>
<p>第二个函数用来设置客户端是否和服务器端一直保持着连接，即使没有任何的数据发送</p>
<p>更多的内容请查看<code>net</code>包的文档。</p>
<p>阻塞Dial：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conn, err := net.Dial(<span class="string">"tcp"</span>, <span class="string">"google.com:80"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">//handle error</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// read or write on conn</span></span><br></pre></td></tr></table></figure>
<p>或是带上超时机制的Dial：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conn, err := net.DialTimeout(<span class="string">"tcp"</span>, <span class="string">":8080"</span>, <span class="number">2</span> * time.Second)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">//handle error</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// read or write on conn</span></span><br></pre></td></tr></table></figure>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/go基础/">go基础</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/go基础/">go基础</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2018/06/03/unposed/第16章-网络编程/" data-title="GO基础【十六】：网络编程 | Bolen`s Blog" data-tsina="zliyong007" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2018/06/03/以太坊私链搭建及智能合约部署/"  title="">
 <strong>下一篇：</strong><br/> 
 <span>(no title)
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#网络编程"><span class="toc-text">网络编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、网络编程基础"><span class="toc-text">一、网络编程基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1通信协议"><span class="toc-text">1.1通信协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2TCP-IP协议"><span class="toc-text">1.2TCP/IP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#附录-OSI-七层参考模型"><span class="toc-text">附录:OSI 七层参考模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-IP-地址和端口号"><span class="toc-text">1.3 IP 地址和端口号</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-IP-地址"><span class="toc-text">1.3.1 IP 地址</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#IPV4地址"><span class="toc-text">IPV4地址</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#IPV6地址"><span class="toc-text">IPV6地址</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-2端口"><span class="toc-text">1.3.2端口</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、TCP编程"><span class="toc-text">二、TCP编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1什么是Socket"><span class="toc-text">2.1什么是Socket</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-TCP-服务端编程"><span class="toc-text">2.2 TCP 服务端编程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-TCP-客户端编程"><span class="toc-text">2.3 TCP 客户端编程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、UDP编程"><span class="toc-text">三、UDP编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-UDP服务器编程"><span class="toc-text">3.2 UDP服务器编程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、net模块其他属性和函数"><span class="toc-text">四、net模块其他属性和函数</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/MySQL笔记/" title="MySQL笔记">MySQL笔记<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/go基础/" title="go基础">go基础<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/others/" title="others">others<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/以太坊源码解读/" title="以太坊源码解读">以太坊源码解读<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/区块链基础/" title="区块链基础">区块链基础<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/go基础/" title="go基础">go基础<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL基础/" title="MySQL基础">MySQL基础<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Blog/" title="Blog">Blog<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/method/" title="method">method<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/interface/" title="interface">interface<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/区块链基础/" title="区块链基础">区块链基础<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/以太坊源码解读/" title="以太坊源码解读">以太坊源码解读<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://liyuechun.org/" target="_blank" title="黎跃春">黎跃春</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.cnblogs.com/bolenzhang" target="_blank" title="My cnblog">My cnblog</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.ruanyifeng.com/blog" target="_blank" title="阮一峰">阮一峰</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=zliyong007&verifier=a1405918&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 立德立言 无问西东 <br/>
			</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/zliyong007" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
		<a href="mailto:zliyong007@163.com## e.g. imjark@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="Bolen Zhang">Bolen Zhang</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
